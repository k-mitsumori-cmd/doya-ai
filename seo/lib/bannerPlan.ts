/**
 * ドヤライティングAI - 記事バナー生成プロンプト（12パターン）
 *
 * design-library.jp のデザインパターンを参考に、
 * 12種類のバナーデザインスタイルを定義。
 * 記事生成時にランダムで4パターンを選択し、4種類の候補を生成する。
 */

export interface BannerPattern {
  id: string
  label: string
  style: string
  prompt: string
}

/**
 * 12パターンのバナーデザインテンプレート
 * {{ARTICLE_TITLE}} / {{ARTICLE_TEXT}} / {{GENRE}} を置換して使用
 */
export const BANNER_PATTERNS: BannerPattern[] = [
  // ─── 1. シンプル・ミニマル ───
  {
    id: 'minimal',
    label: 'シンプル・ミニマル',
    style: 'simple',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】シンプル・ミニマル
- 白またはオフホワイトの背景に、十分な余白
- タイポグラフィが主役。メインコピーは大きく太いゴシック体
- 装飾は最小限（細い線・小さなアクセントカラーのみ）
- 色数は2〜3色以内。差し色は1色だけ
- 余白が「高級感」と「読みやすさ」を演出
- 写真やイラストは使わない or 極小サイズ

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事タイトルの要点を最大20文字程度のメインコピーとして配置し、
ミニマルで洗練されたバナーを生成してください。`,
  },

  // ─── 2. スタイリッシュ・ダーク ───
  {
    id: 'stylish-dark',
    label: 'スタイリッシュ・ダーク',
    style: 'stylish',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】スタイリッシュ・ダーク
- ダークネイビー or チャコールの背景
- 白い文字で強いコントラスト
- アクセントにゴールドまたはシアンを1色
- メインコピーは大きく、モダンなサンセリフ体
- 幾何学的な装飾（斜線・グリッド・ラインアート）
- 知的で信頼感のあるプロフェッショナルな印象

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事の核心を短いメインコピーにし、暗い背景に映える
スタイリッシュなバナーを生成してください。`,
  },

  // ─── 3. ポップ・カラフル ───
  {
    id: 'pop-colorful',
    label: 'ポップ・カラフル',
    style: 'pop',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】ポップ・カラフル
- 明るくビビッドな配色（オレンジ×イエロー、ピンク×パープル等）
- グラデーション背景 or カラーブロック分割
- メインコピーは太字で元気な印象。影や縁取りで視認性UP
- 吹き出し・リボン・星マークなどの装飾OK
- 読むだけでワクワクする、エネルギッシュなデザイン
- 文字には白フチやドロップシャドウで可読性確保

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事の魅力が一目で伝わる、カラフルでポップな
バナーを生成してください。`,
  },

  // ─── 4. ナチュラル・温かみ ───
  {
    id: 'natural-warm',
    label: 'ナチュラル・温かみ',
    style: 'natural',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】ナチュラル・温かみ
- ベージュ・アイボリー・くすみカラーのアースカラー配色
- 手書き風フォントや丸ゴシックで柔らかい印象
- 葉っぱ・水彩テクスチャ・ドットなどの優しい装飾
- 全体的に「やさしい」「安心する」雰囲気
- 角丸のフレームや吹き出しで親しみやすさUP
- 背景に薄い水彩テクスチャやリネン風テクスチャ

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事の内容を優しく伝える、ナチュラルで温かみのある
バナーを生成してください。`,
  },

  // ─── 5. 高級感・プレミアム ───
  {
    id: 'premium',
    label: '高級感・プレミアム',
    style: 'premium',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】高級感・プレミアム
- 黒 or 深い紺の背景にゴールドのアクセント
- 細身のセリフ体 or エレガントなフォント
- 箔押し風・グラデーションゴールドの装飾
- 余白を十分にとった上品なレイアウト
- 飾り罫・エンブレム・細いボーダーで格調高く
- 「特別感」「限定感」を演出

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事の価値を高める、プレミアム感のある
上質なバナーを生成してください。`,
  },

  // ─── 6. テック・グラデーション ───
  {
    id: 'tech-gradient',
    label: 'テック・グラデーション',
    style: 'tech',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】テック・グラデーション
- パープル→ブルー or シアン→グリーンのグラデーション背景
- 抽象的な幾何学模様・ドット・ワイヤーフレーム
- 白いモダンなフォントで未来感
- グロー効果（発光・ネオン風）のアクセント
- テクノロジー・イノベーションを連想させるビジュアル
- 背景に微細なグリッドやパーティクル

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

先進的で革新的な印象を与える、テック系の
バナーを生成してください。`,
  },

  // ─── 7. 雑誌風・エディトリアル ───
  {
    id: 'editorial',
    label: '雑誌風・エディトリアル',
    style: 'editorial',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】雑誌風・エディトリアル
- 雑誌の表紙や見開きページのようなレイアウト
- 大きなタイトル文字と小さなサブテキストの対比
- 写真とテキストエリアの明確な区分け（左右 or 上下分割）
- セリフ体とサンセリフ体のミックス
- 洗練された文字組み・カーニング
- 白黒＋差し色1つの落ち着いた配色

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

雑誌の特集ページのような、洗練された
エディトリアルバナーを生成してください。`,
  },

  // ─── 8. イラスト・アイコン ───
  {
    id: 'illustration',
    label: 'イラスト・アイコン',
    style: 'illustration',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】イラスト・アイコン
- フラットデザインのイラストやアイコンが主役
- パステルカラーや中彩度の明るい配色
- イラストで記事内容を視覚的に表現
- テキストはシンプルに短いコピーのみ
- アイソメトリックやフラットイラストスタイル
- 親しみやすく分かりやすいビジュアル

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事のテーマに合ったイラストを中心に、
分かりやすいバナーを生成してください。`,
  },

  // ─── 9. インフォグラフィック風 ───
  {
    id: 'infographic',
    label: 'インフォグラフィック風',
    style: 'infographic',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】インフォグラフィック風
- 数字・データ・統計を大きく配置
- チャート・グラフ・矢印・アイコンで情報を視覚化
- 3〜4色のカラーパレットで統一感
- 左から右へ、上から下への自然な情報フロー
- 「一目で分かる」情報設計を重視
- メインの数字やキーワードは特大サイズ

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

記事の核となるデータやポイントを視覚化した、
インフォグラフィック風バナーを生成してください。`,
  },

  // ─── 10. ニュース・速報風 ───
  {
    id: 'news-breaking',
    label: 'ニュース・速報風',
    style: 'news',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】ニュース・速報風
- 赤 or オレンジの帯（バナー・ティッカー風）
- 太字の見出しフォント、ニュース番組テロップ風
- 「速報」「最新」「話題」等のラベル
- 背景はダークグレーやネイビーで引き締める
- 斜めのストライプやグラデーション帯
- 緊急感・新鮮さ・注目感を演出

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

ニュース速報のような緊急感と注目感のある
バナーを生成してください。`,
  },

  // ─── 11. カジュアル・手書き風 ───
  {
    id: 'casual-handwritten',
    label: 'カジュアル・手書き風',
    style: 'casual',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】カジュアル・手書き風
- 手書きフォントや手描きイラストを活用
- マスキングテープ・付箋・ノート罫線などの装飾
- クラフト紙やパステルカラーの背景
- メインコピーは手書き風で目立たせる
- 「親しみやすい」「気軽に読める」印象
- デコレーション過多にならない程度の装飾

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

カジュアルで親しみやすい、手書き風のデザインで
バナーを生成してください。`,
  },

  // ─── 12. ビジネス・コーポレート ───
  {
    id: 'business-corporate',
    label: 'ビジネス・コーポレート',
    style: 'business',
    prompt: `記事のアイキャッチバナー画像（1200×628px、16:9）を1枚生成してください。

【デザインスタイル】ビジネス・コーポレート
- 紺・青・グレーを基調とした信頼感のある配色
- 整然としたグリッドレイアウト
- クリーンなサンセリフ体フォント
- ビジネスシーン・オフィスを連想させる背景
- ロゴバッジやタグラインでブランディング
- 信頼・実績・専門性を感じさせる構成

【記事タイトル】{{ARTICLE_TITLE}}
【記事内容】{{ARTICLE_TEXT}}
【ジャンル】{{GENRE}}

ビジネスプロフェッショナルな印象を与える、
信頼感のあるバナーを生成してください。`,
  },
]

/**
 * 記事内容からジャンルを推定
 */
export function guessArticleGenreJa(text: string): string {
  const t = String(text || '').toLowerCase()
  if (/転職|採用|求人|rpo|人材|hr/.test(t)) return '転職/採用'
  if (/itスクール|プログラミングスクール|スクール|学習|教育|研修|資格/.test(t)) return 'ITスクール/学習'
  if (/美容|コスメ|サロン|エステ|スキンケア/.test(t)) return '美容'
  if (/健康|医療|ヘルスケア|病院|福祉|ダイエット/.test(t)) return '健康'
  if (/ec|通販|物販|ショップ|d2c|楽天|アマゾン|amazon/.test(t)) return 'EC'
  if (/ai|人工知能|機械学習|llm|gpt/.test(t)) return 'AI/IT'
  if (/不動産|物件|住宅|建築|リノベ/.test(t)) return '不動産'
  if (/金融|投資|資産|保険|fintech/.test(t)) return '金融'
  if (/マーケ|広告|sns|instagram|twitter|x\\b|meta/.test(t)) return 'マーケティング'
  if (/情報商材|副業|稼ぐ|収入|ノウハウ/.test(t)) return '情報商材'
  return 'ビジネス'
}

/**
 * 12パターンからランダムで n 個選択（重複なし）
 */
export function pickRandomPatterns(count: number = 4): BannerPattern[] {
  const shuffled = [...BANNER_PATTERNS].sort(() => Math.random() - 0.5)
  return shuffled.slice(0, Math.min(count, BANNER_PATTERNS.length))
}

/**
 * パターンのプロンプトに記事情報を埋め込み
 */
export function buildBannerPromptFromPattern(
  pattern: BannerPattern,
  args: {
    title: string
    articleText: string
    genre?: string
  }
): string {
  const title = String(args.title || '').trim().slice(0, 200)
  const articleText = String(args.articleText || '').trim().slice(0, 5000)
  const genre = args.genre || guessArticleGenreJa([title, articleText].join(' '))

  return pattern.prompt
    .replace('{{ARTICLE_TITLE}}', title)
    .replace('{{ARTICLE_TEXT}}', articleText)
    .replace('{{GENRE}}', genre)
}
